defaultRegistry: ghcr.io/streamx-dev/streamx-blueprints
defaultImageTag: 0.0.16-jvm
tenant: streamx

sources:
  cli:
    outgoing:
      - "pages"
      - "assets"
      - "web-resources"
      - "fragments"
      - "data"
      - "renderers"
      - "rendering-contexts"

processing:
  relay-pages:
    image: relay-processing-service
    incoming:
      inchannel:
        topic: inboxes/pages
    outgoing:
      outchannel:
        topic: outboxes/pages
    environment:
      MP_MESSAGING_INCOMING_INCHANNEL_SCHEMA: pageSchema
      MP_MESSAGING_OUTGOING_OUTCHANNEL_SCHEMA: pageSchema

  relay-fragments:
    image: relay-processing-service
    incoming:
      inchannel:
        topic: inboxes/fragments
    outgoing:
      outchannel:
        topic: outboxes/fragments
    environment:
      MP_MESSAGING_INCOMING_INCHANNEL_SCHEMA: fragmentSchema
      MP_MESSAGING_OUTGOING_OUTCHANNEL_SCHEMA: fragmentSchema

  relay-assets:
    image: relay-processing-service
    incoming:
      inchannel:
        topic: inboxes/assets
    outgoing:
      outchannel:
        topic: outboxes/assets
    environment:
      MP_MESSAGING_INCOMING_INCHANNEL_SCHEMA: assetSchema
      MP_MESSAGING_OUTGOING_OUTCHANNEL_SCHEMA: assetSchema

  relay-web-resources:
    image: relay-processing-service
    incoming:
      inchannel:
        topic: inboxes/web-resources
    outgoing:
      outchannel:
        topic: outboxes/web-resources
    environment:
      MP_MESSAGING_INCOMING_INCHANNEL_SCHEMA: webResourceSchema
      MP_MESSAGING_OUTGOING_OUTCHANNEL_SCHEMA: webResourceSchema

  rendering-engine-processing-service:
    image: rendering-engine-processing-service
    incoming:
      data:
        topic: inboxes/data
      renderers:
        topic: inboxes/renderers
      rendering-contexts:
        topic: inboxes/rendering-contexts
      incoming-rendering-requests:
        topic: relays/rendering-requests
    outgoing:
      outgoing-rendering-requests:
        topic: relays/rendering-requests
      pages:
        topic: inboxes/pages
      fragments:
        topic: inboxes/fragments
      compositions:
        topic: inboxes/compositions

delivery:
  web-delivery-service:
    image: web-delivery-service
    incoming:
      pages:
        topic: outboxes/pages
      fragments:
        topic: outboxes/fragments
      assets:
        topic: outboxes/assets
      web-resources:
        topic: outboxes/web-resources
    port: 8081


